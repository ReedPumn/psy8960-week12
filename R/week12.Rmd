---
title: "PSY 8960: Week 12 Project"
author: "Reed Priest"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
---

## Script Settings and Resources

```{r Set wd and load packages}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(tidyverse)
library(RedditExtractoR)
library(tm)
library(qdap)
library(textstem)
```
Come back to this later when I figure out how to download a year's worth of data.
## Data Import and Cleaning
```{r}
# The last approach I used trying to scrape Reddit data using fromJSON produced the same issues from before with page scrolling. So after some Chat GPTing, I found the RedditExtractoR package. It downloaded all the data I needed using this code, but it took about 15 minutes to do so. This package isn't part of the course materials, but it was an effective solution. See this page for details: https://github.com/ivan-rivera/RedditExtractor.

 #reddit_urls <- find_thread_urls(subreddit = "IOPsychology", sort_by = "new", period = "year")
# reddit_content <- get_thread_content(reddit_urls$url)
# week12_tbl <- as_tibble(reddit_content$threads) %>%
  # select(title = title, upvotes = upvotes)
# write_csv(week12_tbl, file = "../data/week12data.csv")
```

```{r Corpus setup}
io_corpus_original <- VCorpus(VectorSource(week12_tbl$title))
io_corpus_trimmed <- io_corpus_original %>%
  tm_map(content_transformer(replace_abbreviation)) %>%
  tm_map(content_transformer(replace_contraction)) %>%
  tm_map(content_transformer(str_to_lower)) %>%
  tm_map(removeNumbers) %>%
  tm_map(removePunctuation) %>%
  tm_map(removeWords, c(stopwords("en"), "io", "io psychology", "io psych")) %>%
  tm_map(stripWhitespace) %>%
  tm_map(content_transformer(lemmatize_words))
```

```{r Comparing corpuses}
compare_them <- function(corpus_origingal, corpus_trimmed) {
  possible <- 1:length(io_corpus_original)
  chosen <- sample(possible, 1)
  compare <- list("Original" = content(io_corpus_original[[chosen]]), "Comparison" = content(io_corpus_trimmed[[chosen]]))
  return(compare)
}
replicate(20, compare_them())
```